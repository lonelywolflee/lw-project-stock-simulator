# [PRD] Python 3.14 기반 코스피 알고리즘 거래 시뮬레이터

## 1. 프로젝트 개요
본 프로젝트는 **Python 3.14** 환경에서 **FinanceDataReader** 라이브러리를 활용하여 대한민국 코스피(KOSPI) 시장의 과거 데이터를 분석하고, 특정 알고리즘 기반의 매매 전략을 테스트하는 **로컬 기반 증권 거래 시뮬레이터**입니다.

## 2. 기술 스택
* **Language:** Python 3.14+ (Faster CPython 및 최신 문법 활용)
* **Library:** * `FinanceDataReader`: 주가 및 시가총액 데이터 수집
    * `Pandas`, `NumPy`: 데이터 분석 및 시뮬레이션 로직
    * `Streamlit`: 인터랙티브 웹 UI 구성
    * `Plotly`: 수익률 및 자산 변동 그래프 시각화

---

## 3. 핵심 기능 요구사항

### 3.1 데이터 수집 (Data Ingestion)
* `FinanceDataReader`를 사용하여 시뮬레이션 기간 내 코스피 전 종목의 **일단위 종가(Close)** 데이터를 가져옴.
* 매수 우선순위 결정을 위한 종목별 **시가총액** 데이터 확보.

### 3.2 매매 알고리즘 (Trading Logic)

#### **[매수 조건 (Buy)]**
1.  **기술적 필터:** $n$일 연속으로 종가가 상승한 종목을 후보군으로 선정.
2.  **정렬 방식 (선택 가능):**
    * 시가총액이 높은 순
    * $n$일간 총 수익률이 높은 순
3.  **자금 배분:** 후보 종목을 정렬 순서대로 종목당 최대 $x1$ 원만큼 매수.
4.  **매수 제한:** 매수 후 남은 예수금이 $x2$ 원 미만이 될 경우 해당일의 추가 매수는 중단.

#### **[매도 조건 (Sell)]**
1.  **추세 하락 매도:** 보유 종목이 $m$일 연속으로 하락할 경우 전량 매도.
2.  **긴급 손절:** 당일 종가가 전일 대비 $y\%$ 이상 하락할 경우 즉시 전량 매도.

#### **[공통 비용]**
* **거래 수수료:** 모든 매수 및 매도 체결 시 금액의 $k\%$를 자산에서 차감.

---

## 4. 사용자 인터페이스 (UI) 및 출력

### 4.1 입력 파라미터 제어 (Sidebar)
* **기본 설정:** 초기 자금, 시뮬레이션 시작일/종료일, 매매 수수료($k$)
* **전략 설정:** 연속 상승일($n$), 연속 하락일($m$), 긴급 매도 하락율($y$)
* **자금 설정:** 구매 상한 금액($x1$), 구매 하한 잔고($x2$)
* **우선순위:** 정렬 방식 선택 (시총 순 vs 수익률 순)

### 4.2 결과 시각화 (Main Panel)
* **그래프:** 일자별 전체 자산(현금+주식) 변화 및 수익률 추이 (KOSPI 지수와 비교 차트)
* **테이블:** 일자별 자산 현황, 보유 종목 리스트, 기간별 누적 수익률 통계
* **주요 지표:** 최종 수익률, 최대 낙폭(MDD), 총 매매 횟수

---

## 5. 개발 로드맵
1.  **Phase 1:** `FinanceDataReader` 기반 데이터 로더 및 전처리 모듈 개발.
2.  **Phase 2:** 일 단위 루프를 통한 백테스팅 코어 엔진(매수/매도 로직) 구현.
3.  **Phase 3:** `Streamlit`을 활용한 파라미터 입력 및 결과 시각화 UI 대시보드 구축.
4.  **Phase 4:** 수수료 및 예외 상황(거래정지 등) 처리를 포함한 로직 고도화.